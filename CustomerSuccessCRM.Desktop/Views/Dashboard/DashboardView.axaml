<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:vm="using:CustomerSuccessCRM.Desktop.ViewModels.Dashboard"
             mc:Ignorable="d" d:DesignWidth="800" d:DesignHeight="450"
             x:Class="CustomerSuccessCRM.Desktop.Views.Dashboard.DashboardView"
             x:DataType="vm:DashboardViewModel">

    <Grid>
        <ScrollViewer>
            <StackPanel Margin="32">
                <TextBlock Text="Visão Geral do sistema"
                           Classes="h1"
                           Margin="0,0,0,32"/>

                <!-- Cards de Estatísticas -->
                <WrapPanel>
                    <!-- Card Total Clientes -->
                    <Border Classes="card" Margin="0,0,24,24" Width="260">
                        <Grid RowDefinitions="Auto,*" ColumnDefinitions="*,Auto">
                            <StackPanel Grid.Row="0" Grid.Column="0" VerticalAlignment="Center">
                                <TextBlock Text="Clientes" Classes="h3" Margin="0,0,0,4"/>
                                <TextBlock Text="{Binding TotalClientes}" Classes="h1"/>
                            </StackPanel>
                            <Border Grid.Column="1" Width="48" Height="48" Background="#e0e7ff" CornerRadius="12">
                                <PathIcon Data="{StaticResource icon_users}" 
                                         Width="22" Height="22"
                                         Foreground="{StaticResource PrimaryColor}"/>
                            </Border>
                        </Grid>
                    </Border>

                    <!-- Card Total Produtos -->
                    <Border Classes="card" Margin="0,0,24,24" Width="260">
                        <Grid RowDefinitions="Auto,*" ColumnDefinitions="*,Auto">
                            <StackPanel Grid.Row="0" Grid.Column="0" VerticalAlignment="Center">
                                <TextBlock Text="Produtos" Classes="h3" Margin="0,0,0,4"/>
                                <TextBlock Text="{Binding TotalProdutos}" Classes="h1"/>
                            </StackPanel>
                            <Border Grid.Column="1" Width="48" Height="48" Background="#dcfce7" CornerRadius="12">
                                <PathIcon Data="{StaticResource icon_box}" 
                                         Width="22" Height="22"
                                         Foreground="#16a34a"/>
                            </Border>
                        </Grid>
                    </Border>

                    <!-- Card Total Metas -->
                    <Border Classes="card" Margin="0,0,24,24" Width="260">
                        <Grid RowDefinitions="Auto,*" ColumnDefinitions="*,Auto">
                            <StackPanel Grid.Row="0" Grid.Column="0" VerticalAlignment="Center">
                                <TextBlock Text="Metas Ativas" Classes="h3" Margin="0,0,0,4"/>
                                <TextBlock Text="{Binding TotalMetas}" Classes="h1"/>
                            </StackPanel>
                            <Border Grid.Column="1" Width="48" Height="48" Background="#fffbeb" CornerRadius="12">
                                <PathIcon Data="{StaticResource icon_target}" 
                                         Width="22" Height="22"
                                         Foreground="#d97706"/>
                            </Border>
                        </Grid>
                    </Border>

                    <!-- Card Conclusão -->
                    <Border Classes="card" Margin="0,0,24,24" Width="260">
                        <Grid RowDefinitions="Auto,*" ColumnDefinitions="*,Auto">
                            <StackPanel Grid.Row="0" Grid.Column="0" VerticalAlignment="Center">
                                <TextBlock Text="Conclusão" Classes="h3" Margin="0,0,0,4"/>
                                <TextBlock Text="{Binding PercentualConclusao, StringFormat='{}{0}%'}" 
                                         Classes="h1"/>
                            </StackPanel>
                            <Border Grid.Column="1" Width="48" Height="48" Background="#f0fdf4" CornerRadius="12">
                                <PathIcon Data="{StaticResource icon_chart}" 
                                         Width="22" Height="22"
                                         Foreground="#15803d"/>
                            </Border>
                        </Grid>
                    </Border>
                </WrapPanel>

                <Grid ColumnDefinitions="*,400" Margin="0,8,0,0">
                    <!-- Lista de Clientes Recentes -->
                    <Border Grid.Column="0" Classes="card" Margin="0,0,24,0">
                        <DockPanel>
                            <TextBlock DockPanel.Dock="Top" Text="Clientes Recentes" Classes="h2" Margin="0,0,0,24"/>
                            <DataGrid ItemsSource="{Binding ClientesRecentes}"
                                      AutoGenerateColumns="False"
                                      IsReadOnly="True"
                                      CanUserResizeColumns="True">
                                <DataGrid.Columns>
                                    <DataGridTextColumn Header="NOME" Binding="{Binding Nome}" Width="1.5*"/>
                                    <DataGridTextColumn Header="EMAIL" Binding="{Binding Email}" Width="2*"/>
                                    <DataGridTextColumn Header="STATUS" Binding="{Binding Status}" Width="*"/>
                                </DataGrid.Columns>
                            </DataGrid>
                        </DockPanel>
                    </Border>

                    <!-- Progresso das Metas -->
                    <Border Grid.Column="1" Classes="card">
                        <DockPanel>
                            <TextBlock DockPanel.Dock="Top" Text="Progresso" Classes="h2" Margin="0,0,0,24"/>
                            <ScrollViewer>
                                <ItemsControl ItemsSource="{Binding Metas}">
                                    <ItemsControl.ItemTemplate>
                                        <DataTemplate>
                                            <StackPanel Margin="0,0,0,20">
                                                <Grid ColumnDefinitions="*,Auto" Margin="0,0,0,8">
                                                    <TextBlock Text="{Binding Descricao}" FontWeight="Medium" Foreground="#1e293b"/>
                                                    <TextBlock Grid.Column="1" 
                                                             Text="{Binding PercentualConclusao, StringFormat='{}{0}%'}"
                                                             FontWeight="Bold" Foreground="{StaticResource PrimaryColor}"/>
                                                </Grid>
                                                <ProgressBar Value="{Binding PercentualConclusao}" 
                                                           Maximum="100"/>
                                            </StackPanel>
                                        </DataTemplate>
                                    </ItemsControl.ItemTemplate>
                                </ItemsControl>
                            </ScrollViewer>
                        </DockPanel>
                    </Border>
                </Grid>
            </StackPanel>
        </ScrollViewer>

        <!-- Loading Overlay -->
        <Border Background="#40111827" IsVisible="{Binding IsLoading}">
            <Border Background="White" HorizontalAlignment="Center" VerticalAlignment="Center"
                    Padding="32" CornerRadius="16" BoxShadow="0 10 30 0 #40000000">
                <StackPanel Spacing="16">
                    <ProgressBar IsIndeterminate="True" Width="120"/>
                    <TextBlock Text="Sincronizando dados..." HorizontalAlignment="Center" FontWeight="Medium"/>
                </StackPanel>
            </Border>
        </Border>
    </Grid>

</UserControl> 